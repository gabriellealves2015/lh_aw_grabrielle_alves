version: 2

models:
  - name: agg_territory_sales_person
    description: >
      Aggregated table composed by the union of the dimensions of 
      Customer, Product, Employee, Credit Card, Territory and 
      the fact of Order Details.

    columns:
      - name: sk_order_details
        description: The surrogate key of the fact order detail.
        tests:
          - unique
          - not_null

      - name: sk_sales_order
        description: The surrogate key of the sales order.
        tests:
          - not_null

      - name: fk_product
        description: >
          The foreign key of the products dimension.
        tests:
          - not_null

      - name: product_name
        description: >
          The product name.

      - name: category_name
        description: >
          The category name.

      - name: fk_customer
        description: >
          The foreign key of the customers dimension.
        tests:
          - not_null

      - name: customer_full_name
        description: >
          The person complete name (first, middle and last).

      - name: person_type
        description: >
          The customer classification (Store, Natural Person or Store Contact).

      - name: fk_creditcard
        description: >
          The foreign key of the creditcards dimension.

      - name: card_type
        description: >
          The type of creditcard.

      - name: fk_territory
        description: >
          The foreign key of the territories dimension.
        tests:
          - not_null

      - name: city_name
        description: >
          The city name.

      - name: state_province_name
        description: >
          The name state province.

      - name: country_name
        description: >
          The country name.

      - name: fk_employee
        description: >
          The foreign key of the employees dimension.

      - name: city_name
        description: >
          The city name.

      - name: state_province_name
        description: >
          The name state province.

      - name: country_name
        description: >
          The country name.

      - name: tax
        description: >
          Tax rate distributed per item.
      
      - name: freight
        description: >
          Shipping cost distributed per item.
        
      - name: due
        description: >
          Due from customer, computed as: subtotal + tax_amt + freight, distributed per item.
      
      - name: is_online
        description: >
          Information if order was placed by sales person or online by customer.
      
      - name: order_type
        description: >
          Qualifies the order as physical or online based on the is_online column.

      - name: order_date
        description: >
          The date when sales order was created.
      
      - name: order_quantity
        description: >
          Quantity ordered per product.
      
      - name: subtotal
        description: >
          Amount calculated by product: unit_price * order_quantity * (1 - unit_price_discount)
      
      - name: total
        description: >
          Amount calculated by product: subtotal + tax distributed per product + freight distributed per product
